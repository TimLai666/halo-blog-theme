<th:block xmlns:th="http://www.thymeleaf.org">
  <th:insert th:replace="~{modules/head :: headFragment}"></th:insert>

  <body class="theme theme--post theme--read" th:classappend="${theme.config.style.color_scheme} == 'dark' ? ' theme--dark' :
                        (${theme.config.style.color_scheme} == 'light' ? ' theme--light' : ' theme--system')" th:attr="data-accent=${theme.config.style.accent},
                 data-serif=${theme.config.style.serif_body},
                 data-progress=${theme.config.layout.show_reading_progress},
                 data-reduce-motion=${theme.config.style.reduce_motion}">

    <div class="progress" th:if="${theme.config.layout.show_reading_progress}">
      <div class="progress__bar" id="readingProgress"></div>
    </div>

    <!-- Minimal header for reading mode -->
    <header class="rh">
      <a class="rh__back" th:href="${site.url}" href="/">←</a>
      <a class="rh__brand" th:href="${site.url}" href="/">
        <span class="rh__dot" aria-hidden="true"></span>
        <span th:text="${site.title}">Site</span>
      </a>
      <a class="rh__toTop" href="#top" title="回到頂部">↑</a>
    </header>

    <main id="top" class="post">
      <section class="post__hero">
        <div class="post__heroInner">
          <p class="post__kicker">
            <span th:if="${post.categories}">
              <a class="post__kickerLink" th:each="c, st : ${post.categories}" th:href="${c.status.permalink}"
                th:text="${c.spec.displayName}" th:append="${st.last} ? '' : ' · '">分類</a>
            </span>
            <span th:if="${post.spec.publishTime}">
              <span class="post__dot">·</span>
              <time th:text="${#temporals.format(post.spec.publishTime, 'yyyy-MM-dd')}">2026-01-01</time>
            </span>
          </p>

          <h1 class="post__title" th:text="${post.spec.title}">Title</h1>

          <p class="post__lead" th:if="${post.status.excerpt}" th:text="${post.status.excerpt}">
            excerpt
          </p>

          <!-- cover is optional; if exists, show as subtle ambient block -->
          <div class="post__ambient" th:if="${post.spec.cover}">
            <img th:src="${post.spec.cover}" alt="" loading="lazy" />
          </div>
        </div>
      </section>

      <article class="post__content" th:classappend="${theme.config.style.serif_body} ? ' prose--serif' : ''">
        <div class="prose" th:utext="${post.content.content}"></div>
      </article>

      <footer class="post__footer">
        <div class="post__tags" th:if="${post.tags}">
          <span class="tag tag--solid" th:each="t : ${post.tags}" th:text="${t.spec.displayName}">tag</span>
        </div>

        <div class="post__meta">
          <span th:if="${post.stats}" th:text="'瀏覽 ' + ${post.stats.visit}">瀏覽 0</span>
          <span class="post__sep">·</span>
          <a th:href="${site.routes.archivesUri}" href="/archives">回所有文章</a>
        </div>
      </footer>
    </main>

    <th:insert th:replace="~{modules/footer :: footerFragment}"></th:insert>